<!DOCTYPE html>
<html>
<head>
	<title>NotUber: COMP20 Assignment 2</title>
	<meta charset="utf-8">
	<link href="style.css" rel="stylesheet" />
</head>
<body onload="getMyLocation()">

<div id="map"> <h1> Loading...</h1> </div>

<script>
    myLat = 0;
	myLng = 0;
	
	
	function getMyLocation() {
		navigator.geolocation.getCurrentPosition(gotLocation);
	}

	function gotLocation(position) {
		myLat = position.coords.latitude;
		myLng = position.coords.longitude;	
		initMap(); 
		performRequest(); 
	}


	function performRequest() {
	rideRequest = new XMLHttpRequest(); 
	rideRequest.open("POST", "https://jordan-marsh.herokuapp.com/rides", true);
	rideRequest.setRequestHeader ("Content-type", "application/x-www-form-urlencoded"); 

	rideRequest.onreadystatechange = function() {
				if (rideRequest.readyState == 4 && rideRequest.status == 200) {
					responseInfo = rideRequest.responseText; 
					responseInfo = JSON.parse(responseInfo); 
					userMap ();  
				}
			}
	rideRequest.send("username=nzLw9wQbNd&lat=" + myLat + "&lng=" + myLng); 
	
	}

    function initMap() {
    	map = new google.maps.Map(document.getElementById('map'), {
        	center: {lat: myLat, lng: myLng},
        	zoom: 15
        	});
      }

    function userMap () {
    	

    } 

    </script>

<script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAA3e7VPgMhZFgCEqXFvt4fnh9jNvpe4C8">
</script>
	




</body>
</html>